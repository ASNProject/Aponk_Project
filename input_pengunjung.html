<!DOCTYPE html>
<!--=== Coding by CodingLab | www.codinglabweb.com === -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!----======== CSS ======== -->
    <link rel="stylesheet" href="style3.css" />

    <!----===== Iconscout CSS ===== -->
    <link
      rel="stylesheet"
      href="https://unicons.iconscout.com/release/v4.0.0/css/line.css"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
      integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!--<title>Responsive Regisration Form </title>-->
  </head>
  <body>
    <div class="container">
      <a href="dashboard.html" class="kembali" style="margin-bottom: 40px">
        <i class="uil uil-previous"></i>
        <span>Kembali</span>
      </a>
      <header>Masukkan data pengunjung</header>

      <form action="#">
        <div class="form first">
          <div class="content">
            <div class="details personal">
              <span class="title">Personal Data Pengunjung</span>

              <div class="fields">
                <div class="input-field">
                  <label>Nama Lengkap</label>
                </div>
                <div class="input-field">
                  <input
                    type="text"
                    placeholder="Masukkan nama"
                    required
                    id="setnama"
                    style="width: 100%"
                  />
                </div>

                <div class="input-field">
                  <label>Alamat</label>
                </div>
                <div class="input-field">
                  <input
                    type="text"
                    placeholder="Masukkan alamat"
                    required
                    id="setalamat"
                    style="width: 100%"
                  />
                </div>

                <div class="input-field">
                  <label>Instansi</label>
                </div>
                <div class="input-field">
                  <select required style="width: 100%" id="setinstansi">
                    <option disabled selected>Pilih instansi</option>
                    <option>TNI/POLRI</option>
                    <option>PNS</option>
                    <option>UMUM</option>
                  </select>
                </div>

                <div class="input-field">
                  <label>Nomor Identitas (KTP/SIM/PASPOR)</label>
                </div>
                <div class="input-field">
                  <input
                    type="number"
                    placeholder="Masukkan no identitas"
                    required
                    id="setnoidentitas"
                    style="width: 100%"
                  />
                </div>

                <div class="input-field">
                  <label>Kewarganegaraan</label>
                </div>
                <div class="input-field">
                  <select required style="width: 100%" id="setwarganegara">
                    <option disabled selected>Pilih kewarganegaraan</option>
                    <option>WNI</option>
                    <option>WNA</option>
                  </select>
                </div>

                <div class="input-field">
                  <label>Jenis Kelamin</label>
                </div>
                <div class="input-field">
                  <select required style="width: 100%" id="setjeniskelamin">
                    <option disabled selected>Pilih jenis kelamin</option>
                    <option>Laki-laki</option>
                    <option>Perempuan</option>
                  </select>
                </div>

                <div class="input-field">
                  <label>Kelompok Usia</label>
                </div>

                <div class="input-field">
                  <select required style="width: 100%" id="setkelompokusia">
                    <option disabled selected>Pilih kelompok usia</option>
                    <option>Anak-anak</option>
                    <option>Dewasa</option>
                    <option>Lansia</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="details ID">
              <span class="title">Keperluan</span>

              <div class="input-field" style="display: flex">
                <textarea id="setkeperluan" rows="5" cols="40">
Tulis keperluan</textarea
                >
              </div>
            </div>
          </div>
          <div style="display: flex">
            <button class="nextBtn" onclick="storeFirebase()">
              <span class="btnText">Sumbit</span>
              <i class="uil uil-navigator"></i>
            </button>

            <button
              class="download"
              style="margin-left: 20px"
              onclick="Convert_HTML_to_PDF()"
            >
              <span class="btnText">Download</span>
              <i class="uil uil-download-alt"></i>
            </button>
          </div>
        </div>
      </form>
    </div>

    <!--<script src="script.js"></script>-->

    <script>
      let div = document.querySelector(".content");
      let btn = document.querySelector(".download");

      var opt = {
        margin: [40, 40, 30, 30], //top, left, buttom, right
        filename: name + ".pdf",
        image: { type: "jpeg", quality: 0.98 },
        html2canvas: { dpi: 192, scale: 2, letterRendering: true },
        jsPDF: { unit: "pt", format: "a4", orientation: "portrait" },
        pageBreak: { mode: "css", after: ".break-page" },
      };
      btn.addEventListener("click", () => {
        html2pdf().from(div).set(opt).save();
      });
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

    <script id="MainScript">
      var firebaseConfig = {
        apiKey: "AIzaSyDMDphm6xCuGC7JQjcLwi4hU3Y5eSsX8jQ",
        authDomain: "aponk-82561.firebaseapp.com",
        databaseURL: "https://aponk-82561-default-rtdb.firebaseio.com",
        projectId: "aponk-82561",
        storageBucket: "aponk-82561.appspot.com",
        messagingSenderId: "814528637046",
        appId: "1:814528637046:web:a246200b62d4e800121757",
        measurementId: "G-0NB8RSBWLV",
      };
      firebase.initializeApp(firebaseConfig);

      var year;
      const y = new Date();
      y.getFullYear();
      year = y.getFullYear();
      const months = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];

      const m = new Date();
      let month = months[m.getMonth()];

      var day;
      const d = new Date();
      d.getDate();
      if (d.getDate <= 10) {
        day = "0" + d.getDate();
      } else {
        day = d.getDate();
      }
      console.log(month);

      function storeFirebase() {
        var nama = document.getElementById("setnama");
        var alamat = document.getElementById("setalamat");
        var instansi = document.getElementById("setinstansi");
        var identitas = document.getElementById("setnoidentitas");
        var warga = document.getElementById("setwarganegara");
        var kelamin = document.getElementById("setjeniskelamin");
        var kemopok = document.getElementById("setkelompokusia");
        var keperluans = document.getElementById("setkeperluan");

        firebase
          .database()
          .ref()
          .child("DataHarian")
          .child(year)
          .child(month)
          .child(day)
          .child("Pengunjung")
          .child(identitas.value)
          .child(nama.value)
          .set(keperluans.value);

        firebase
          .database()
          .ref()
          .child("DataBulanan")
          .child(year)
          .child(month)
          .child("Pengunjung")
          .child(identitas.value)
          .child(nama.value)
          .set(keperluans.value);

        firebase
          .database()
          .ref()
          .child("DataTahunan")
          .child(year)
          .child("Pengunjung")
          .child(identitas.value)
          .child(nama.value)
          .set(keperluans.value);

        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("nama")
          .set(nama.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("alamat")
          .set(alamat.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("instansi")
          .set(instansi.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("noidentitas")
          .set(identitas.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("kewarganegaraan")
          .set(warga.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("jeniskelamin")
          .set(kelamin.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("kelompokusia")
          .set(kemopok.value);
        firebase
          .database()
          .ref()
          .child("DataPengunjungWeb")
          .child(identitas.value)
          .child("keperluan")
          .set(keperluans.value);
      }
    </script>
  </body>
</html>
